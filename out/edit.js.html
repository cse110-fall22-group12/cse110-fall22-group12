<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: edit.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: edit.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
  get_selected_data_id,
  NEW_DATA_INDEX,
  get_selected_data,
  overwrite_selected_data,
  create_new_data,
} from './data.js';

window.addEventListener('DOMContentLoaded', init);

/**
 * Starts the program and initialize the edit page.
 * @global
 */
function init() {
  const edit = get_selected_data_id() != NEW_DATA_INDEX;
  construct_header(edit);
  construct_body(edit);
}

/**
 * Constructs the edit page.
 * @global
 * @param {boolean}   edit  Whether the user is editing or adding a new recipe.
 */
function construct_body(edit) {
  if (edit) {
    const data = get_selected_data();
    document.getElementById('edit-name').value = data.name;
    document.getElementById('edit-ingredients').value = data.ingredients;
    document.getElementById('edit-steps').value = data.steps;
    document.getElementById('edit-notes').value = data.notes;
  }
}

/**
 * Constructs the header.
 * @global
 * @param {boolean}   edit  Whether the user is editing or adding a new recipe.
 */
function construct_header(edit) {
  let showing_alert_box = false;
  const back = document.getElementById('edit-back');
  const save = document.getElementById('edit-save');
  // initialize the back button:
  back.addEventListener('click', function() {
    if (showing_alert_box) {
      return;
    }
    // jump back to the correct page:
    if (get_selected_data_id() != NEW_DATA_INDEX) {
      window.location.href = 'view.html';
    } else {
      window.location.href = 'home.html';
    }
  });
  // initialize the save button:
  save.addEventListener('click', function() {
    if (showing_alert_box) {
      return;
    }
    // check if name is blank, if so alert user and don't save
    if (document.getElementById('edit-name').value === '') {
      const editElement = document.getElementById('edit-button-box');
      editElement.style.display = 'block';
      const name = document.getElementById('edit-name');
      const ingredients = document.getElementById('edit-ingredients');
      const steps = document.getElementById('edit-steps');
      const notes = document.getElementById('edit-notes');
      name.setAttribute('disabled', 'disabled');
      ingredients.setAttribute('disabled', 'disabled');
      steps.setAttribute('disabled', 'disabled');
      notes.setAttribute('disabled', 'disabled');
      showing_alert_box = true;
    } else if (get_selected_data_id() != NEW_DATA_INDEX) {
      const data = get_selected_data();
      data.name = document.getElementById('edit-name').value.trim();
      data.ingredients = document.getElementById('edit-ingredients').value;
      data.steps = document.getElementById('edit-steps').value;
      data.notes = document.getElementById('edit-notes').value;
      overwrite_selected_data(data);
      window.location.href = 'view.html';
    } else {
      const name = document.getElementById('edit-name').value.trim();
      const ingredients = document.getElementById('edit-ingredients').value;
      const steps = document.getElementById('edit-steps').value;
      const notes = document.getElementById('edit-notes').value;
      create_new_data(name, ingredients, steps, notes);
      window.location.href = 'home.html';
    }
  });

  const ok_button = document.getElementById('ok-edit-button');
  ok_button.addEventListener('click', function(event) {
    const editElement = document.getElementById('edit-button-box');
    editElement.style.display = 'none';
    const name = document.getElementById('edit-name');
    const ingredients = document.getElementById('edit-ingredients');
    const steps = document.getElementById('edit-steps');
    const notes = document.getElementById('edit-notes');
    name.removeAttribute('disabled');
    ingredients.removeAttribute('disabled');
    steps.removeAttribute('disabled');
    notes.removeAttribute('disabled');
    showing_alert_box = false;
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Recipe_Cell.html">Recipe_Cell</a></li></ul><h3>Global</h3><ul><li><a href="global.html#DATA_ARRAY_KEY">DATA_ARRAY_KEY</a></li><li><a href="global.html#DEV_MODE">DEV_MODE</a></li><li><a href="global.html#ID_GENERATOR_KEY">ID_GENERATOR_KEY</a></li><li><a href="global.html#NEW_DATA_INDEX">NEW_DATA_INDEX</a></li><li><a href="global.html#SELECTED_DATA_ID_KEY">SELECTED_DATA_ID_KEY</a></li><li><a href="global.html#add_sample_data">add_sample_data</a></li><li><a href="global.html#append_recipe_as_child">append_recipe_as_child</a></li><li><a href="global.html#construct_body">construct_body</a></li><li><a href="global.html#construct_header">construct_header</a></li><li><a href="global.html#create_new_data">create_new_data</a></li><li><a href="global.html#delete_selected_data">delete_selected_data</a></li><li><a href="global.html#get_data">get_data</a></li><li><a href="global.html#get_selected_data">get_selected_data</a></li><li><a href="global.html#get_selected_data_id">get_selected_data_id</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#is_launched_for_the_first_time">is_launched_for_the_first_time</a></li><li><a href="global.html#overwrite_selected_data">overwrite_selected_data</a></li><li><a href="global.html#read_data_array">read_data_array</a></li><li><a href="global.html#select_data_by_id">select_data_by_id</a></li><li><a href="global.html#set_data">set_data</a></li><li><a href="global.html#template_data">template_data</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Sat Dec 03 2022 07:06:56 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
